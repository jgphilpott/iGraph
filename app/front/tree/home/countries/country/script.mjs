import {rainbow} from "../../../../libs/mjs/colors/solid/rainbow.mjs"
import {regionsColourSwitch} from "../../../../libs/mjs/colors/switches/regions.mjs"
import {makeScrollable} from "../../../../libs/mjs/panels/events/scroll.mjs"

$(document).ready(function() {

  $("body").append("<canvas id='canvas'></canvas>")

  summonParticleWeb(42, rainbow)

  let country = data.country

  $("body").append("<div id='country' class='panel'><a href='/api/countries/" + country.code + "'><h1 id='name'>" + country.name + "</h1></a></div>")

  let panel = $("#country.panel")

  panel.append("<img class='flag' src='/front/imgs/flags/" + country.code + ".png'>")
  panel.append("<p><b>Formal Name:</b> " + country.formal_name + "</p>")
  panel.append("<p><b>Region:</b> " + country.region + "</p>")

  panel.append("<svg id='miniMap'></svg>")

  socket.emit("get_maps")

  socket.on("new_maps", function(maps) {

    console.log(maps)

    let index = 0
    let inv = null
    let centers = []

    function nextMap() {

      $(".map").remove()
      $('svg').off('click')

      console.log(index);
      console.log(maps[index].properties.name)

      let map = {"type": "FeatureCollection", "features": [maps[index]], "properties": {"λ": 0, "φ": 0, "γ": 0}}

      let canvas = d3.select("#miniMap")
      let projection = d3.geoEquirectangular().fitSize([500, 500], map)
      let path = d3.geoPath().projection(projection)

      canvas.selectAll(".map")
            .data(map.features)
            .enter()
            .append("path")
            .attr("d", path)
            .attr("class", "map")
            .attr("fill", function(feature) {

                return "gray"

            })

        index += 1

        $("svg").click(function(event) {

          inv = projection.invert([event.pageX, event.pageY])
          console.log(inv)

        })

    }

    nextMap()

    $(document).keypress(function(event) {

      if (event.keyCode == 32) {

        if (index < maps.length) {

          centers.push({"code": maps[index - 1].properties.code, "long": inv[0], "lat": inv[1]})
          console.log(centers)
          nextMap()

        } else {

          console.log("done!")

        }

      }

    })

  })

  makeScrollable(panel)

})




[
  {
    "code": "AFG",
    "long": 65.95985742187501,
    "lat": 34.1834701171875
  },
  {
    "code": "AGO",
    "long": 17.758964843750046,
    "lat": -12.420308593749985
  },
  {
    "code": "ALB",
    "long": 20.030093164062517,
    "lat": 41.17468789062501
  },
  {
    "code": "AND",
    "long": 1.5456507812500104,
    "lat": 42.5425033203125
  },
  {
    "code": "ARE",
    "long": 54.49869375000003,
    "lat": 23.535126562500015
  },
  {
    "code": "ARG",
    "long": -64.154085546875,
    "lat": -33.03414042968746
  },
  {
    "code": "ARM",
    "long": 44.86742500000005,
    "lat": 40.331629882812514
  },
  {
    "code": "ATG",
    "long": -61.7937412109375,
    "lat": 17.379989648437512
  },
  {
    "code": "AUS",
    "long": 135.21064648437505,
    "lat": -24.821347656250026
  },
  {
    "code": "AUT",
    "long": 14.79937460937502,
    "lat": 47.547948242187495
  },
  {
    "code": "AZE",
    "long": 47.67904296875007,
    "lat": 40.46951269531248
  },
  {
    "code": "BDI",
    "long": 29.869935546875013,
    "lat": -3.4101382812500005
  },
  {
    "code": "BEL",
    "long": 4.675050781250006,
    "lat": 50.81584414062503
  },
  {
    "code": "BEN",
    "long": 2.3359280273437553,
    "lat": 10.102032714843743
  },
  {
    "code": "BFA",
    "long": -1.6621398437499881,
    "lat": 12.3620716796875
  },
  {
    "code": "BGD",
    "long": 90.15410595703128,
    "lat": 24.31690283203124
  },
  {
    "code": "BGR",
    "long": 25.19007968750002,
    "lat": 42.665778124999996
  },
  {
    "code": "BHR",
    "long": 50.553426171875,
    "lat": 26.067938281249994
  },
  {
    "code": "BHS",
    "long": -75.91636210937497,
    "lat": 24.150850000000034
  },
  {
    "code": "BIH",
    "long": 17.875646484375032,
    "lat": 44.19513574218748
  },
  {
    "code": "BLR",
    "long": 28.266871093750016,
    "lat": 53.49564648437499
  },
  {
    "code": "BLZ",
    "long": -88.75167753906246,
    "lat": 17.138812304687512
  },
  {
    "code": "BOL",
    "long": -64.62517871093749,
    "lat": -17.012861718750003
  },
  {
    "code": "BRA",
    "long": -50.405708398437504,
    "lat": -10.08727656250003
  },
  {
    "code": "BRB",
    "long": -59.564237890625,
    "lat": 13.177678906250001
  },
  {
    "code": "BRN",
    "long": 114.61953906250004,
    "lat": 4.462550195312516
  },
  {
    "code": "BTN",
    "long": 90.41777324218751,
    "lat": 27.472925781249998
  },
  {
    "code": "BWA",
    "long": 23.82621875000001,
    "lat": -21.982948437500006
  },
  {
    "code": "CAF",
    "long": 20.268627929687497,
    "lat": 6.8147646484374915
  },
  {
    "code": "CAN",
    "long": -100.89193564453127,
    "lat": 59.038240917968835
  },
  {
    "code": "CHE",
    "long": 8.185397265625006,
    "lat": 46.928399999999996
  },
  {
    "code": "CHL",
    "long": -71.07961171875,
    "lat": -34.548959960937495
  },
  {
    "code": "CHN",
    "long": 105.2804443359375,
    "lat": 34.419458007812494
  },
  {
    "code": "CIV",
    "long": -5.503729882812507,
    "lat": 7.6906414062500295
  },
  {
    "code": "CMR",
    "long": 12.563346777343758,
    "lat": 5.0284954101562445
  },
  {
    "code": "COD",
    "long": 23.76424492187501,
    "lat": -2.050452343750012
  },
  {
    "code": "COG",
    "long": 15.710565625000012,
    "lat": -0.7975617187500058
  },
  {
    "code": "COL",
    "long": -73.050754296875,
    "lat": 3.96585625
  },
  {
    "code": "COM",
    "long": 43.83510585937502,
    "lat": -11.925563671874963
  },
  {
    "code": "CPV",
    "long": -24.086189453125,
    "lat": 16.117638671875035
  },
  {
    "code": "CRI",
    "long": -84.04850273437496,
    "lat": 10.125029882812495
  },
  {
    "code": "CUB",
    "long": -79.01749375000004,
    "lat": 21.866961718749995
  },
  {
    "code": "CYP",
    "long": 33.212028125000025,
    "lat": 35.02561718749999
  },
  {
    "code": "CZE",
    "long": 15.137347265625015,
    "lat": 49.9014015625
  },
  {
    "code": "DEU",
    "long": 10.125651757812518,
    "lat": 51.113819921875
  },
  {
    "code": "DJI",
    "long": 42.498828125,
    "lat": 11.807128906249995
  },
  {
    "code": "DMA",
    "long": -61.34582275390623,
    "lat": 15.45373720703125
  },
  {
    "code": "DNK",
    "long": 9.507978125000045,
    "lat": 55.920957031250005
  },
  {
    "code": "DOM",
    "long": -70.491963671875,
    "lat": 19.00909902343749
  },
  {
    "code": "DZA",
    "long": 2.7987291015625035,
    "lat": 28.122106835937505
  },
  {
    "code": "ECU",
    "long": -78.26804492187499,
    "lat": -1.406727050781233
  },
  {
    "code": "EGY",
    "long": 29.643497265625008,
    "lat": 26.678908789062497
  },
  {
    "code": "ERI",
    "long": 38.16614257812497,
    "lat": 15.873194335937521
  },
  {
    "code": "ESP",
    "long": -3.366984765624949,
    "lat": 39.97716601562503
  },
  {
    "code": "EST",
    "long": 25.922084179687545,
    "lat": 58.695589453125024
  },
  {
    "code": "ETH",
    "long": 39.619775000000025,
    "lat": 8.495110156249996
  },
  {
    "code": "FIN",
    "long": 26.729531250000022,
    "lat": 63.64254179687503
  },
  {
    "code": "FJI",
    "long": 179.28000000000003,
    "lat": -19.251406250000006
  },
  {
    "code": "FRA",
    "long": 3.2843416015624944,
    "lat": 45.02430917968749
  },
  {
    "code": "FSM",
    "long": 158.2564638671875,
    "lat": 6.787058203124987
  },
  {
    "code": "GAB",
    "long": 11.728652832031251,
    "lat": -0.496130371093753
  },
  {
    "code": "GBR",
    "long": -1.481227734374983,
    "lat": 52.198277539062495
  },
  {
    "code": "GEO",
    "long": 43.579820507812514,
    "lat": 42.01206015624999
  },
  {
    "code": "GHA",
    "long": -1.1436247070312446,
    "lat": 7.964672851562497
  },
  {
    "code": "GIN",
    "long": -10.879789648437486,
    "lat": 10.991464648437491
  },
  {
    "code": "GMB",
    "long": -15.31376445312498,
    "lat": 13.564054785156243
  },
  {
    "code": "GNB",
    "long": -14.803775781249927,
    "lat": 12.1867810546875
  },
  {
    "code": "GNQ",
    "long": 10.528852929687535,
    "lat": 1.5643097656250162
  },
  {
    "code": "GRC",
    "long": 22.462479687500018,
    "lat": 39.36937792968752
  },
  {
    "code": "GRD",
    "long": -61.68226201171875,
    "lat": 12.119072460937497
  },
  {
    "code": "GTM",
    "long": -90.419412890625,
    "lat": 15.376636328124997
  },
  {
    "code": "GUY",
    "long": -58.9074240234375,
    "lat": 4.625433300781245
  },
  {
    "code": "HND",
    "long": -86.59513281249998,
    "lat": 14.945168945312524
  },
  {
    "code": "HRV",
    "long": 16.506152343750063,
    "lat": 44.825024414062504
  },
  {
    "code": "HTI",
    "long": -73.022059375,
    "lat": 18.868109375000046
  },
  {
    "code": "HUN",
    "long": 19.457728906250015,
    "lat": 47.2075158203125
  },
  {
    "code": "IDN",
    "long": 117.81678906250006,
    "lat": -2.7759355468749836
  },
  {
    "code": "IND",
    "long": 79.13616093750007,
    "lat": 22.114359570312505
  },
  {
    "code": "IRL",
    "long": -7.711449511718712,
    "lat": 53.19290761718752
  },
  {
    "code": "IRN",
    "long": 54.204103125,
    "lat": 33.20660449218753
  },
  {
    "code": "IRQ",
    "long": 43.445004882812505,
    "lat": 32.98322265625
  },
  {
    "code": "ISL",
    "long": -17.792900585937485,
    "lat": 64.81350771484375
  },
  {
    "code": "ISR",
    "long": 34.976722656250004,
    "lat": 31.573172851562493
  },
  {
    "code": "ITA",
    "long": 12.485638476562535,
    "lat": 42.975931054687514
  },
  {
    "code": "JAM",
    "long": -77.32623554687498,
    "lat": 18.1654107421875
  },
  {
    "code": "JOR",
    "long": 36.24469492187501,
    "lat": 31.133719921875
  },
  {
    "code": "JPN",
    "long": 139.4528796875,
    "lat": 36.70435722656246
  },
  {
    "code": "KAZ",
    "long": 68.43170781250011,
    "lat": 48.731967187500004
  },
  {
    "code": "KEN",
    "long": 37.89199218750002,
    "lat": 0.7665992187499956
  },
  {
    "code": "KGZ",
    "long": 75.26646679687501,
    "lat": 41.73073632812499
  },
  {
    "code": "KHM",
    "long": 105.00488359375001,
    "lat": 12.642726171874997
  },
  {
    "code": "KIR",
    "long": -21.538780078124994,
    "lat": 17.89117265624998
  },
  {
    "code": "KNA",
    "long": -62.69436708984373,
    "lat": 17.29350917968749
  },
  {
    "code": "KOR",
    "long": 128.0263006835938,
    "lat": 36.259478710937515
  },
  {
    "code": "KWT",
    "long": 47.490784960937525,
    "lat": 29.364921289062536
  },
  {
    "code": "LAO",
    "long": 103.88403320312504,
    "lat": 18.842708886718775
  },
  {
    "code": "LBN",
    "long": 35.8371591796875,
    "lat": 33.864373046874995
  },
  {
    "code": "LBR",
    "long": -9.252764843749992,
    "lat": 6.394270312499995
  },
  {
    "code": "LBY",
    "long": 18.149104687500007,
    "lat": 27.2896962890625
  },
  {
    "code": "LCA",
    "long": -60.977701367187485,
    "lat": 13.888182812499998
  },
  {
    "code": "LIE",
    "long": 9.537764648437507,
    "lat": 47.124800781249995
  },
  {
    "code": "LKA",
    "long": 80.79238281249998,
    "lat": 7.626050488281284
  },
  {
    "code": "LSO",
    "long": 28.179138867187508,
    "lat": -29.54652070312502
  },
  {
    "code": "LTU",
    "long": 24.01402050781256,
    "lat": 55.30484804687496
  },
  {
    "code": "LUX",
    "long": 6.0817000000000005,
    "lat": 49.7355982421875
  },
  {
    "code": "LVA",
    "long": 24.88160625000002,
    "lat": 56.994846484374996
  },
  {
    "code": "MAR",
    "long": -9.980015429687477,
    "lat": 28.368017578124974
  },
  {
    "code": "MCO",
    "long": 7.405521875000012,
    "lat": 43.753146484374994
  },
  {
    "code": "MDA",
    "long": 28.571678125000012,
    "lat": 47.350418945312505
  },
  {
    "code": "MDG",
    "long": 46.73501269531254,
    "lat": -19.472612890625
  },
  {
    "code": "MDV",
    "long": 73.467394921875,
    "lat": 3.762963671875034
  },
  {
    "code": "MEX",
    "long": -102.16836718749997,
    "lat": 23.693781250000015
  },
  {
    "code": "MHL",
    "long": 170.009469140625,
    "lat": 6.8091480468750385
  },
  {
    "code": "MKD",
    "long": 21.665779687500017,
    "lat": 41.6244845703125
  },
  {
    "code": "MLI",
    "long": -3.626606835937481,
    "lat": 15.48850791015625
  },
  {
    "code": "MLT",
    "long": 14.336250390625,
    "lat": 35.97732187500001
  },
  {
    "code": "MMR",
    "long": 96.17874482421878,
    "lat": 20.538414648437517
  },
  {
    "code": "MNE",
    "long": 19.185568750000012,
    "lat": 42.801279296874995
  },
  {
    "code": "MNG",
    "long": 103.43465156250002,
    "lat": 46.341921484375
  },
  {
    "code": "MOZ",
    "long": 34.68049648437501,
    "lat": -18.367837499999997
  },
  {
    "code": "MRT",
    "long": -10.040364648437475,
    "lat": 19.48569912109379
  },
  {
    "code": "MUS",
    "long": 57.56425234375003,
    "lat": -20.285050000000005
  },
  {
    "code": "MWI",
    "long": 34.12687109375004,
    "lat": -13.077372265625014
  },
  {
    "code": "MYS",
    "long": 108.31833769531255,
    "lat": 3.1650505859375104
  },
  {
    "code": "NAM",
    "long": 17.298968750000004,
    "lat": -22.303441406250005
  },
  {
    "code": "NER",
    "long": 8.853491210937518,
    "lat": 16.627522460937506
  },
  {
    "code": "NGA",
    "long": 7.605773828125061,
    "lat": 9.528884375000017
  },
  {
    "code": "NIC",
    "long": -84.98965400390624,
    "lat": 12.808527050781253
  },
  {
    "code": "NLD",
    "long": 5.651998046875031,
    "lat": 51.99010214843751
  },
  {
    "code": "NOR",
    "long": 16.11074560546874,
    "lat": 65.74567939453125
  },
  {
    "code": "NPL",
    "long": 84.00927343750001,
    "lat": 28.227923828125
  },
  {
    "code": "NRU",
    "long": 166.93308339843753,
    "lat": -0.5199455078125029
  },
  {
    "code": "NZL",
    "long": 172.1393205078125,
    "lat": -44.773753906249965
  },
  {
    "code": "OMN",
    "long": 56.37355039062501,
    "lat": 20.434492675781232
  },
  {
    "code": "PAK",
    "long": 69.59268359375001,
    "lat": 29.92025
  },
  {
    "code": "PAN",
    "long": -80.22829687499997,
    "lat": 8.747178125000024
  },
  {
    "code": "PER",
    "long": -74.75468349609373,
    "lat": -10.218692773437505
  },
  {
    "code": "PHL",
    "long": 122.63362226562512,
    "lat": 11.84605859374999
  },
  {
    "code": "PLW",
    "long": 134.58575000000005,
    "lat": 7.496358593749983
  },
  {
    "code": "PNG",
    "long": 144.4851796875,
    "lat": -6.159797656249974
  },
  {
    "code": "POL",
    "long": 19.55618203125001,
    "lat": 52.188873632812495
  },
  {
    "code": "PRK",
    "long": 126.82071484374998,
    "lat": 40.26985234374999
  },
  {
    "code": "PRT",
    "long": -8.117854882812502,
    "lat": 39.548906152343775
  },
  {
    "code": "PRY",
    "long": -58.36229492187499,
    "lat": -23.100470703125005
  },
  {
    "code": "QAT",
    "long": 51.20080175781251,
    "lat": 25.298592285156246
  },
  {
    "code": "ROU",
    "long": 25.011684375000005,
    "lat": 45.94821054687499
  },
  {
    "code": "RUS",
    "long": 102.24000000000001,
    "lat": 61.52673339843751
  },
  {
    "code": "RWA",
    "long": 29.84690039062501,
    "lat": -1.9237261718750025
  },
  {
    "code": "SAU",
    "long": 45.04451406249998,
    "lat": 24.079946093750006
  },
  {
    "code": "SDN",
    "long": 30.116677734375,
    "lat": 16.34037890625
  },
  {
    "code": "SEN",
    "long": -15.04974257812499,
    "lat": 14.848047265624999
  },
  {
    "code": "SGP",
    "long": 103.82121386718748,
    "lat": 1.3589951171874946
  },
  {
    "code": "SLB",
    "long": 159.45809687500002,
    "lat": -8.74798691406251
  },
  {
    "code": "SLE",
    "long": -11.750859570312464,
    "lat": 8.476258007812493
  },
  {
    "code": "SLV",
    "long": -88.843683984375,
    "lat": 13.692373242187498
  },
  {
    "code": "SMR",
    "long": 12.45953046875,
    "lat": 43.941683398437505
  },
  {
    "code": "SOM",
    "long": 45.602825585937495,
    "lat": 6.074361718749992
  },
  {
    "code": "SRB",
    "long": 20.795759082031235,
    "lat": 44.0460220703125
  },
  {
    "code": "SSD",
    "long": 30.35287910156252,
    "lat": 7.256375390624997
  },
  {
    "code": "STP",
    "long": 7.059359375000021,
    "lat": 0.978954687500009
  },
  {
    "code": "SUR",
    "long": -55.93946093749999,
    "lat": 4.175222363281243
  },
  {
    "code": "SVK",
    "long": 19.496348437500014,
    "lat": 48.714622265624996
  },
  {
    "code": "SVN",
    "long": 14.802869335937514,
    "lat": 46.070513476562496
  },
  {
    "code": "SWE",
    "long": 15.789413281250047,
    "lat": 63.06781660156251
  },
  {
    "code": "SWZ",
    "long": 31.500339062499997,
    "lat": -26.586010546875002
  },
  {
    "code": "SYC",
    "long": 55.48540585937501,
    "lat": -4.659923046875007
  },
  {
    "code": "SYR",
    "long": 38.46825097656251,
    "lat": 35.05787128906248
  },
  {
    "code": "TCD",
    "long": 18.8435796875,
    "lat": 14.9172765625
  },
  {
    "code": "TGO",
    "long": 1.0851306640625151,
    "lat": 8.612567089843743
  },
  {
    "code": "THA",
    "long": 101.0934166015625,
    "lat": 14.538930761718754
  },
  {
    "code": "TJK",
    "long": 71.20310312499997,
    "lat": 38.890646874999966
  },
  {
    "code": "TKM",
    "long": 59.618114062500055,
    "lat": 39.200800976562505
  },
  {
    "code": "TLS",
    "long": 125.94003125000008,
    "lat": -8.786810546875
  },
  {
    "code": "TON",
    "long": -174.53247460937496,
    "lat": -19.79445019531253
  },
  {
    "code": "TTO",
    "long": -61.27102050781253,
    "lat": 10.440986328124996
  },
  {
    "code": "TUN",
    "long": 9.146000195312537,
    "lat": 34.01243925781249
  },
  {
    "code": "TUR",
    "long": 35.39625234375001,
    "lat": 39.268725390624994
  },
  {
    "code": "TUV",
    "long": 178.84036754652013,
    "lat": -8.05580641075984
  },
  {
    "code": "TZA",
    "long": 34.915786132812535,
    "lat": -6.065922851562504
  },
  {
    "code": "UGA",
    "long": 32.46353300781251,
    "lat": 1.193062109374994
  },
  {
    "code": "UKR",
    "long": 31.382028906250056,
    "lat": 49.30639824218746
  },
  {
    "code": "URY",
    "long": -56.026237597656255,
    "lat": -32.878196679687505
  },
  {
    "code": "USA",
    "long": -98.72418964843745,
    "lat": 37.115338476562506
  },
  {
    "code": "UZB",
    "long": 62.805853320312565,
    "lat": 42.15321054687502
  },
  {
    "code": "VCT",
    "long": -61.212208984374996,
    "lat": 13.106415039062485
  },
  {
    "code": "VEN",
    "long": -66.0019171875,
    "lat": 7.353471289062517
  },
  {
    "code": "VNM",
    "long": 106.05189697265624,
    "lat": 16.141376953125015
  },
  {
    "code": "VUT",
    "long": 168.14585839843755,
    "lat": -17.080151953124997
  },
  {
    "code": "WSM",
    "long": -172.0927748046875,
    "lat": -13.790802832031238
  },
  {
    "code": "YEM",
    "long": 47.69273046875005,
    "lat": 15.490098828125037
  },
  {
    "code": "ZAF",
    "long": 25.430464843750013,
    "lat": -29.442369921875006
  },
  {
    "code": "ZMB",
    "long": 27.82021484375002,
    "lat": -13.281134765625003
  },
  {
    "code": "ZWE",
    "long": 29.971479492187523,
    "lat": -19.178212890625005
  }
]
